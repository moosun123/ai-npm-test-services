<template>
  <AuthWrapper :options="options" @auth-click="handleClick">
    <template #default="{ loading, disabled }">
      <mtd-button class="auth-router-link" type="text" :loading="loading" :disabled="disabled">
        <slot></slot>
      </mtd-button>
    </template>
  </AuthWrapper>
</template>

<script lang="ts">
import Vue from 'vue'
import { Component, Prop } from 'vue-property-decorator'
import { Route } from 'vue-router'
import AuthWrapper from './AuthWrapper.vue'

@Component({
  components: {
    AuthWrapper
  }
})
export default class AuthRouterLink extends Vue {
  @Prop({
    type: [Object, String]
  })
  to: Route | string

  /** 类型和AuthWrapper保持一致 */
  @Prop(Object)
  options: any

  handleClick() {
    this.$emit('click')

    if (!this.to) {
      return
    }

    const newRoute =
      typeof this.to === 'string'
        ? this.to
        : {
            name: this.to.name || undefined,
            path: this.to.path,
            hash: this.to.hash,
            query: this.to.query,
            params: this.to.params,
          }

    this.$router.push(newRoute)
  }
}
</script>
<style lang="scss" scoped>
.auth-router-link {
  color: #0a70f5;
  padding: 0;
  text-align: left;
  white-space: normal;
  height: unset;

  &:hover {
    text-decoration: underline;
  }
}
</style>
<style lang="scss">
.auth-router-link {
  .mtd-btn-spin {
    height: 22px;
    line-height: 22px;
  }

  .mtd-btn>span {
    line-height: 22px;
  }
}
</style>
