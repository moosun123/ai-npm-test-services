import * as path from 'path';
import { updateLibInfoApi, fatalLog } from '@ss/components-manage-tools';

const chalk = require('chalk');
const inquirer = require('inquirer');

export const updateLibInfo = async (libType: any) => {
    if (!libType) {
        fatalLog('update lib is must be have an libType(component or template).');
    }
    const { confirmUpdate } = await inquirer.prompt([{
        type: 'list',
        message: 'Please pick is confirm update lib info?',
        name: 'confirmUpdate',
        choices: ['yes', 'no']
    }]);
    if (confirmUpdate === 'yes') {
        const updateParams = require(path.join(process.cwd(), 'libInfo.json'));
        console.log(chalk.gray('update lib info start.'));
        await updateLibInfoApi(updateParams, libType);
        console.log(chalk.green('update lib info success.'));
    }
    process.exit(0);
};