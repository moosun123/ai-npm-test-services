import * as path from 'path';
import { registerApi, fatalLog } from '@ss/components-manage-tools';

const chalk = require('chalk');
const inquirer = require('inquirer');

export const register = async (registerType: any) => {
    if (!registerType) {
        fatalLog('register is must be have an registerType(component or template).');
    }
    const { confirmRegister } = await inquirer.prompt([{
        type: 'list',
        message: 'Please pick is confirm register.',
        name: 'confirmRegister',
        choices: ['yes', 'no']
    }]);
    if (confirmRegister === 'yes') {
        const registerParams = require(path.join(process.cwd(), 'libInfo.json'));
        console.log(chalk.gray('register start.'));
        await registerApi(registerParams, registerType);
        console.log(chalk.green('register success.'));
    }
    process.exit(0);
};