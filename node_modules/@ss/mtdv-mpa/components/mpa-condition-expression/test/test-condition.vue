<template>
    <div class="selector-container">
        <mtd-select
            v-model="value.key"
            @change="selectedValues = []"
            :disabled="disabled"
            style="width: 200px"
        >
            <mtd-option
                v-for="item in options"
                :key="item.value"
                :label="item.label"
                :value="item.value"
            />
        </mtd-select>
        <mtd-select v-model="value.operator" :disabled="disabled" style="width: 200px">
            <mtd-option
                v-for="item in operate"
                :key="item.value"
                :label="item.label"
                :value="item.value"
            />
        </mtd-select>
        <mtd-select
            v-model="selectedValues"
            :disabled="disabled"
            multiple
            clearable
            style="width: 200px"
        >
            <mtd-option
                v-for="item in selectValuesOptions"
                :key="item.value"
                :label="item.label"
                :value="item.value"
            />
        </mtd-select>
    </div>
</template>
<script lang="ts">
import { Vue, Component, Prop } from 'vue-property-decorator';
@Component
export default class TestCondition extends Vue {
    @Prop({
        type: Object,
        default: () => {
            return {
                key: '',
                operator: '',
                value: ''
            };
        },
    })
    private value;

    @Prop({
        type: Boolean,
        default: false,
    })
    private disabled;

    private options = [
        {
            label: '属相',
            value: '01',
        },
        {
            label: '优惠敏感度',
            value: '02',
        },
        {
            label: '用户类型',
            value: '03',
        },
        {
            label: '是否登录',
            value: '04',
        },
    ];

    private operate = [
        {
            label: '=',
            value: '=',
        },
        {
            label: '包含',
            value: 'in',
        },
        {
            label: '不包含',
            value: 'notin',
        },
    ];

    private get selectValuesOptions() {
        const obj = {
            '01': [
                {
                    label: '鼠',
                    value: '鼠',
                },
                {
                    label: '牛',
                    value: '牛',
                },
                {
                    label: '虎',
                    value: '虎',
                },
                {
                    label: '兔',
                    value: '兔',
                },
                {
                    label: '龙',
                    value: '龙',
                },
                {
                    label: '蛇',
                    value: '蛇',
                },
                {
                    label: '马',
                    value: '马',
                },
                {
                    label: '羊',
                    value: '羊',
                },
                {
                    label: '猴',
                    value: '猴',
                },
                {
                    label: '鸡',
                    value: '鸡',
                },
                {
                    label: '狗',
                    value: '狗',
                },
                {
                    label: '猪',
                    value: '猪',
                },
            ],
            '02': [
                {
                    label: '敏感度高',
                    value: '敏感度高',
                },
                {
                    label: '敏感度低',
                    value: '敏感度低',
                },
                {
                    label: '敏感度一般',
                    value: '敏感度一般',
                },
            ],
            '03': [
                {
                    label: '高频用户',
                    value: '高频用户',
                },
                {
                    label: '低频用户',
                    value: '低频用户',
                },
                {
                    label: '普通用户',
                    value: '普通用户',
                },
            ],
            '04': [
                {
                    label: '是',
                    value: '是',
                },
                {
                    label: '否',
                    value: '否',
                },
            ],
        };
        return obj[this.value.key] || [];
    }

    private get selectedValues() {
        const value = this.value.value;
        return value ? value.split(',') : [];
    }

    private set selectedValues(value: string[]) {
        this.value.value = value.join(',');
    }

    public validate() {
        const {key, operator, value} = this.value;
        if (!key || !operator || !value) {
            return "输入不能为空";
        }
    }
}
</script>
<style lang="scss" scoped>
.selector-container {
    > div {
        margin-right: 10px;
        &:last-child {
            margin-right: 0px;
        }
    }
}
</style>
