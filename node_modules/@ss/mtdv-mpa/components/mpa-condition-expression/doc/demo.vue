<template>
    <div>
        <h1>条件表达式</h1>
        <h2>简介</h2>
        <p>
            条件关系表达式由条件与关系信息共同构成，并常用条件表达式构成多个赋值语句，表达式内外均可通过“且”、“或”以及顺序等逻辑进行嵌套和组合。
        </p>
        <h3>使用场景</h3>
        <div class="flex-wrap">
            <div class="flex">
                <h4>圈选范围</h4>
                <ul>
                    <li>人群圈选，主要应用于用户分析中用户分群功能下</li>
                    <li>订单圈选， 主要应用于经营分析中</li>
                    <li>条件筛选， 一般辅助其他分析组件缩小目标范围</li>
                </ul>
            </div>
            <div class="flex">
                <h4>定义事件</h4>
                <ul>
                    <li>事件分析， 分析目标事件某时间下的数据表现</li>
                    <li>LTV分析， 分析应收事件的收益表现</li>
                </ul>
            </div>
            <div class="flex">
                <h4>定义行为</h4>
                <ul>
                    <li>留存分析，定义节点行为后分析留存结果</li>
                    <li>间隔分析， 定义前后行为后分析间隔数据的表现</li>
                </ul>
            </div>
        </div>

        <h2>推荐样例</h2>
        <h3>类型一：基本使用</h3>
        <p>【应用范围】可满足绝大部分内容圈选类场景，用户可直接通过“下拉”/“新增”定义多组条件。</p>
        <p>【常见案例】订单圈选--通过条件定义订单各参数情况，圈选出特定的订单名单。</p>
        <p>
            内部依赖组件<a href="#" @click.prevent="goHash('#' + testCondition)">{{
                testCondition
            }}</a>
        </p>
        <Base></Base>
        <h3>示例二 预先设定分类条件</h3>
        <p>【应用范围】适合“条件类型固定”或“需要明确提示用户存在哪些条件类型”的圈选场景。</p>
        <p>【常见案例】某人群圈选平台只能允许用户针对“用户属性”、“用户行为”、“行为序列”等三个方面做条件的设置，可通过预先设定分类条件的形式进行设计。</p>
        <p>
            内部依赖组件<a href="#" @click.prevent="goHash('#' + testCondition)">{{
                testCondition
            }}</a
            >、<a href="#" @click.prevent="goHash('#' + uaCondition)">{{ uaCondition }}</a>
        </p>
        <BaseWithHeader></BaseWithHeader>
        <h3>示例三 拆分类别决策步骤</h3>
        <p>【应用范围】适合不同类型条件设定内容差别较大的场景。</p>
        <p>【常见案例】某人群圈选平台，针对用户行为的条件需要设定：时间、动作、具体参数、参数大小等一些列信息；但针对用户所属分群的条件只需要设定用户所在分群。</p>
        <p>
            内部依赖组件<a href="#" @click.prevent="goHash('#' + uaCondition)">{{ uaCondition }}</a>、<a href="#" @click.prevent="goHash('#' + testCondition)">{{ testCondition }}</a>、<a href="#" @click.prevent="goHash('#' + groupCase)">{{ groupCase }}</a>
        </p>
        <MultTypes></MultTypes>

        <h3>示例四 定义事件</h3>
        <p>【应用范围】适用用于需要通过条件定义一个或多个事件的场景。</p>
        <p>【常见案例】LTV分析--需要通过条件的定义分析营收事件的收益表现。</p>
        <p>
            内部依赖组件<a href="#" @click.prevent="goHash('#' + eventCase)">{{ eventCase }}</a>、<a href="#" @click.prevent="goHash('#' + testCondition)">{{ testCondition }}</a>
        </p>
        <DefineEvent></DefineEvent>
        <h3>示例五 定义行为</h3>
        <p>【应用范围】适用于需要定义两个行为间先后顺序的场景。</p>
        <p>【常见案例】间隔分析--通过条件表达式定义前一个行为和后一个行为后，两个行为间隔的数据表现。</p>
        <p>
            内部依赖组件<a href="#" @click.prevent="goHash('#' + behaviorCase)">{{
                behaviorCase
            }}</a
            >、<a href="#" @click.prevent="goHash('#' + testCondition)">{{ testCondition }}</a>
        </p>
        <Behavior></Behavior>
        <h2>以下为示例数据中comp字段组件的内部实现， 仅供参考</h2>
        <h3>{{ testCondition }}</h3>
        <TestCondition v-model="testConditionValue"></TestCondition>
        <h3>{{ uaCondition }}</h3>
        <UaCondition v-model="uaConditionValue"></UaCondition>
        <h3>{{ uaSelector }}</h3>
        <UaSelector></UaSelector>
        <h3>{{ behaviorCase }}</h3>
        <BehaviorCase></BehaviorCase>
        <h3>{{ eventCase}}</h3>
        <EventCase></EventCase>
        <h3>{{groupCase}}</h3>
        <GroupCase></GroupCase>
    </div>
</template>
<script lang="ts">
import { Vue, Component } from 'vue-property-decorator';
import Base from './example/base.vue';
import BaseWithHeader from './example/baseWithHeader.vue';
import AddAndDel from './example/addAndDel.vue';
import NoRootCondition from './example/noRootCondition.vue';
import MultComp from './example/multComp.vue';
import Behavior from './example/behavior.vue';
import MultTypes from './example/multTypes.vue';
import DefineEvent from './example/defineEvent.vue';
import TestCondition from './test/test-condition.vue';
import UaCondition from './test/ua-condition.vue';
import UaSelector from './test/ua-selector.vue';
import BehaviorCase from './test/behavior-case.vue';
import EventCase from './test/event-case.vue';
import GroupCase from './test/group-case.vue';

const sharpMatcherRegx = /#([^#/]+)$/;
@Component({
    components: {
        Base,
        BaseWithHeader,
        AddAndDel,
        NoRootCondition,
        MultComp,
        Behavior,
        TestCondition,
        UaCondition,
        UaSelector,
        BehaviorCase,
        MultTypes,
        DefineEvent,
        EventCase,
        GroupCase
    },
})
export default class Demo extends Vue {
    private testCondition = 'test-condition';
    private uaCondition = 'ua-condition';
    private uaSelector = 'ua-selector';
    private behaviorCase = 'behavior-case';
    private eventCase = 'event-case';
    private groupCase = 'group-case';

    private testConditionValue = {
        key: '01',
        operator: 'in',
        value: '',
    };

    private uaConditionValue = {
        type: 2,
        labelId: '22',
        operator: '>',
        value: '10',
    };

    private goHash(hash) {
        let hashUrl = location.hash;
        const sharpLinkMatch = sharpMatcherRegx.exec(hashUrl);
        if (sharpLinkMatch) {
            hashUrl = hashUrl.replace(sharpLinkMatch[0], '');
        }
        location.hash = hashUrl + '' + hash;
    }
}
</script>
<style lang="scss" scoped>
.flex-wrap {
    display: flex;
    flex: auto;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
}
.flex {
    border: 1px solid #e9e9e9;
    border-radius: 13px;
    width: 32%;
    margin-right: 2%;
    padding: 20px;
    h3 {
        margin-bottom: 10px;
    }
}
.flex:last-child {
    margin-right: 0;
}
</style>
