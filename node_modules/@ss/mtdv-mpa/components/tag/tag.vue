<template>
    <span :class="className" @click="handleClick">
        <span :class="`${prefix}-content`">
            <slot />
        </span>
        <span :class="`${prefix}-close`" v-if="canClosed" @click="handleClose"
            ><Icon name="close" :class="`${prefix}-close-icon`" /><Icon
                name="error-circle"
                :class="`${prefix}-close-hover-icon`"
            />
        </span>
    </span>
</template>
<script>
import { CONFIG_PROVIDER, getPrefixCls, getSize } from '../../utils/config';
import Icon from '@components/icon';

export default {
    name: 'MtdTag',
    components: {
        Icon
    },
    model: {
        prop: 'checked'
    },
    props: {
        size: String,
        theme: {
            type: String,
            default: 'blue'
        },
        closeable: Boolean, // 兼容历史
        closable: {
            type: Boolean,
            default: false
        },
        disabled: {
            type: Boolean,
            default: false
        },
        type: {
            type: String
        },
        rounded: Boolean
        // checkable: Boolean, // 暂时下掉
        // checked: Boolean,
    },
    inject: {
        config: {
            from: CONFIG_PROVIDER,
            default: {
                getPrefixCls,
                getSize
            }
        }
    },
    computed: {
        prefix() {
            return this.config.getPrefixCls('tag');
        },
        _size() {
            return this.config.getSize(this);
        },
        className() {
            const { prefix } = this;
            return {
                [prefix]: true,
                [`${prefix}-${this.theme}`]: this.theme,
                [`${prefix}-${this._size}`]: this._size,
                [`${prefix}-rounded`]: this.rounded,
                [`${prefix}-${this.type}`]: this.type,
                [`${prefix}-closable`]: this.canClosed,
                [`${prefix}-disabled`]: this.disabled,
                [`${prefix}-clickable`]: !!this.$listeners.click
            };
        },
        canClosed() {
            return this.closeable || this.closable;
        }
    },
    methods: {
        handleClose(e) {
            e.preventDefault();
            e.stopPropagation();
            if (this.disabled) {
                return false;
            }
            this.$emit('close', e);
        },
        handleClick(e) {
            e.preventDefault();
            if (this.disabled) {
                return false;
            }
            // if (this.checkable) {
            //   const value = !this.checked;
            //   this.$emit('change', value);
            //   this.$emit('input', value);
            // }
            this.$emit('click', e);
        }
    }
};
</script>
