"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTemplateCodeUrl = exports.getTemplateListAndCodeUrl = void 0;
const log_1 = require("../util/log");
const login_1 = require("./login");
const constant_1 = require("../util/constant");
const fetch = require('node-fetch');
const getTemplateListAndCodeUrl = async (templateLibId) => {
    (0, login_1.checkLogin)();
    const _octo = await (0, constant_1.getSignature)();
    try {
        const value = await fetch(`${constant_1.envHost}/openapi/v1/template/templateLibInfo?templateLibId=${templateLibId}`, {
            method: 'GET',
            headers: {
                "Content-Type": 'application/json',
                "oceanus-auth": _octo
            },
        });
        const res = await value.json();
        if (res.code !== 0) {
            (0, log_1.fatalLog)(res.message);
        }
        else {
            return res.data || [];
        }
    }
    catch (e) {
        (0, log_1.fatalLog)(`register component failed: ${e}.`);
    }
};
exports.getTemplateListAndCodeUrl = getTemplateListAndCodeUrl;
const getTemplateCodeUrl = async (templateId) => {
    (0, login_1.checkLogin)();
    const _octo = await (0, constant_1.getSignature)();
    try {
        const value = await fetch(`${constant_1.envHost}/openapi/v1/template/templateInfo?templateId=${templateId}`, {
            method: 'GET',
            headers: {
                "Content-Type": 'application/json',
                "oceanus-auth": _octo
            },
        });
        const res = await value.json();
        if (res.code !== 0) {
            (0, log_1.fatalLog)(res.message);
        }
        else {
            return res.data || {};
        }
    }
    catch (e) {
        (0, log_1.fatalLog)(`register component failed: ${e}.`);
    }
};
exports.getTemplateCodeUrl = getTemplateCodeUrl;
