<template>
  <mtd-picker v-model="value" ref="picker" :multiple="multiple">
    <mtd-option v-for="(item, index) in options" :key="index"
      :value="item.value"
      :label="item.label"
    />
  </mtd-picker>
</template>
<script>
import MtdPicker from '@components/picker';
import MtdOption from '@components/option';
import {
  triggerClick,
  waitImmediate,
  findVM,
} from '@test/util';

export default {
  components: {
    MtdPicker,
    MtdOption,
  },
  data () {
    return {
      value: null,
      multiple: true,
      options: [{
        label: '是',
        value: true,
      }, {
        label: '否',
        value: false,
      }],
    };
  },
  methods: {
    async doTest (done) {
      this.$refs.picker.focus();
      await waitImmediate();
      const picker = findVM(this.$refs.picker, {
        name: 'Picker',
      });
      const { options } = picker;
      triggerClick(options[0].$el);
      await waitImmediate();
      expect(this.value).to.be.eql([this.options[0].value]);
      expect(picker.valueText).to.be.eql(this.options[0].label);

      this.value = undefined;
      this.$refs.picker.focus();
      await waitImmediate();
      triggerClick(options[1].$el);
      await waitImmediate();
      expect(this.value).to.be.eql([this.options[1].value]);
      expect(picker.valueText).to.be.eql(this.options[1].label);

      done();
    },
  },
};
</script>
