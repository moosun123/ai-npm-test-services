import { mount } from '@vue/test-utils';
import Notification from '../component.vue';

describe('Notification', function () {
  it('create', () => {
    const wrapper = mount(Notification);
    expect(wrapper.vm).to.exist;
  });

  it('test title', () => {
    const wrapper = mount(Notification, {
      data () {
        return {
          title: 'my title',
        };
      },
    });
    expect(wrapper.find('.mtd-notification-title').text()).to.equal('my title');
  });

  it('test string message', () => {
    const wrapper = mount(Notification, {
      data () {
        return {
          message: 'string message',
        };
      },
    });
    expect(wrapper.find('.mtd-notification-content').text()).to.equal('string message');
  });

  it('test html message', () => {
    const wrapper = mount(Notification, {
      data () {
        return {
          message: '<p>html message</p>',
          dangerouslyUseHTMLString: true,
        };
      },
    });
    expect(wrapper.find('.mtd-notification-content').find('p').text()).to.equal('html message');
  });

  it('invoke with type', () => {
    const wrapper = mount(Notification, {
      data () {
        return {
          message: 'super!',
          type: 'success',
        };
      },
    });
    expect(wrapper.find('i').find('.mtdicon-success-circle').exists()).to.be.true;
  });

  it('test custom class', () => {
    const wrapper = mount(Notification, {
      data () {
        return {
          message: 'super!',
          className: 'my-skr',
        };
      },
    });
    expect(wrapper.find('.mtd-notification').find('.my-skr').exists()).to.be.true;
  });

  it('test icon class', () => {
    const wrapper = mount(Notification, {
      data () {
        return {
          message: 'super!',
          icon: 'mtdicon-search',
        };
      },
    });
    expect(wrapper.find('i').find('.mtdicon-search').exists()).to.be.true;
  });

  it('test custom pop position', () => {
    const wrapper = mount(Notification, {
      data () {
        return {
          message: 'super!',
          position: 'bottom-left',
        };
      },
    });
    expect(wrapper.find('.mtd-notification').find('.left').exists()).to.be.true;
    expect(wrapper.find('.mtd-notification').attributes().style).to.contain('bottom');
  });

  it('hide close btn', () => {
    const wrapper = mount(Notification, {
      data () {
        return {
          message: 'super!',
          showClose: false,
        };
      },
    });
    expect(wrapper.find('.mtd-notification-close').exists()).to.not.be.true;
  });

  it('custom close method', () => {
    const closeSpy = sinon.spy();
    const wrapper = mount(Notification, {
      data () {
        return {
          message: 'super!',
          onClose: closeSpy,
        };
      },
    });

    expect(wrapper.find('.mtd-notification-close').exists()).to.be.true;
    wrapper.find('.mtd-notification-close').trigger('click');
    closeSpy.should.have.been.calledOnce;
  });
});
