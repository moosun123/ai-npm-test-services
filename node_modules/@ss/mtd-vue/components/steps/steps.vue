<template>
  <div
  :class="[
    prefix,
    _size && `${prefix}-${_size}`,
    !isCenter && `${prefix}-right`,
    direction && `${prefix}-${direction}`,
  ]">
    <slot />
  </div>
</template>
<script>
import { CONFIG_PROVIDER,
  getPrefixCls,
  getSize,
} from '@/utils/config';
export default {
  name: 'MtdSteps',
  props: {
    size: String,
    dot: {
      type: Boolean,
      default: false,
    },
    space: [String, Number],
    direction: {
      type: String,
      default: 'horizontal',
    },
    active: {
      type: Number,
      default: 0,
    },
    status: {
      type: String,
      default: 'process',
    },
    isCenter: {
      type: Boolean,
      default: true,
    },
    simple: Boolean,
  },
  provide () {
    return {
      steps: this,
    };
  },
  inject: {
    config: {
      from: CONFIG_PROVIDER,
      default: {
        getPrefixCls,
        getSize,
      },
    },
  },
  data () {
    return {
      steps: [],
    };
  },
  computed: {
    prefix () {
      return this.config.getPrefixCls('steps');
    },
    _size () {
      return this.config.getSize(this);
    },
  },
  watch: {
    steps (steps) {
      steps.forEach((child, index) => {
        child.index = index;
      });
    },
  },
  created () {
    this.$on('addStep', this.add);
    this.$on('removeStep', this.remove);
  },
  methods: {
    add (step) {
      this.steps.push(step);
    },
    remove (step) {
      const index = this.steps.indexOf(step);
      if (index > -1) {
        this.steps.splice(index, 1);
      }
    },
  },
};
</script>
