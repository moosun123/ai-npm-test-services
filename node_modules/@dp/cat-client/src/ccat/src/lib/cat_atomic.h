//
// Created by Terence on 2018/8/14.
//

#ifndef CCAT_CAT_ATOMIC_H
#define CCAT_CAT_ATOMIC_H

#ifdef WIN32

#define CAT_ATOMICLONG volatile long

#define CAT_ATOMICLONG_INC(pAtomicInt) InterlockedIncrement(pAtomicInt)
#define CAT_ATOMICLONG_DEC(pAtomicInt) InterlockedDecrement(pAtomicInt)
#define CAT_ATOMICLONG_ADD(pAtomicInt, addVal) InterlockedAdd(pAtomicInt, addVal)
#define CAT_ATOMICLONG_FAA(pAtomicInt, addVal) InterlockedExchangeAdd(pAtomicInt, addVal)
#define CAT_ATOMICLONG_CAS(pAtomicInt, update, expect) InterlockedCompareExchange(pAtomicInt, update, expect)

#elif defined(__linux) || defined(__APPLE__)

#define CAT_ATOMICLONG volatile long

#define CAT_ATOMICLONG_INC(pAtomicInt) __sync_add_and_fetch(pAtomicInt, 1)
#define CAT_ATOMICLONG_DEC(pAtomicInt) __sync_add_and_fetch(pAtomicInt, -1)
#define CAT_ATOMICLONG_ADD(pAtomicInt, addVal) __sync_add_and_fetch(pAtomicInt, addVal)
#define CAT_ATOMICLONG_FAA(pAtomicInt, addVal) __sync_fetch_and_add(pAtomicInt, addVal)
#define CAT_ATOMICLONG_CAS(pAtomicInt, expect, update) __sync_bool_compare_and_swap(pAtomicInt, expect, update)

#endif

#endif //CCAT_CAT_ATOMIC_H
