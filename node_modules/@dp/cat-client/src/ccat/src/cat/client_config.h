#ifndef CAT_CLIENT_C_CLIENT_CONFIG_H
#define CAT_CLIENT_C_CLIENT_CONFIG_H

#include "lib/cat_sds.h"
#include "cat/batch_dispatcher.h"

#include "cat/client.h"

typedef struct _CatClientInnerConfig {
    catsds domain;
    catsds hostname;
    catsds env;

    catsds defaultIp;
    catsds defaultIpHex;

    int serverNum;
    catsds *serverAddresses;

    int messageQueueSize;
    int maxContextElementSize;

    catsds dataDir;
    catsds indexFileName;

    int slotCount;

    volatile double sampleRatio;

    int routerType;

    int longUrl;
    int longService;
    int longCall;
    int longSql;
    int longCache;
    int longMq;

    int block;

    uint8_t userHasDisabledHeartbeat;
    volatile uint8_t enableHeartbeat;
    volatile uint8_t enableAutoInitialize;

    uint32_t loggingLevelForDefaultCatLogger;
    CatLogger *logger;
    char *componentSwitch;
    int aggregatorInterval;
    int msgCountPerSecond;
    int failLogLimit;
    uint32_t transactionBatchQueueCapacity;
    uint32_t eventBatchQueueCapacity;

    CatBatchDispatcher *transactionBatchDispatcher;
    CatBatchDispatcher *eventBatchDispatcher;

} CatClientInnerConfig;

#define CAT_ROUTER_NORMAL 0
#define CAT_ROUTER_JSON 1

#define CAT_REMOTE_SERVER "cat.sankuai.com"

#define DEFAULT_XML_FILE "/data/appdatas/cat/client.xml"
#define DEFAULT_ENV_FILE "/data/webapps/appenv"

#define DEFAULT_APPKEY "cat"
#define DEFAULT_IP "127.0.0.1"
#define DEFAULT_IP_HEX "7f000001"

#if defined(__linux__) || defined(__APPLE__)
#define DEFAULT_DATA_DIR "/data/appdatas/cat/"
#else
#define DEFAULT_DATA_DIR "./"
#endif

extern CatClientInnerConfig g_config;

void initCatClientConfig(CatClientConfig *config);

void catClientConfigLock();

void catClientConfigUnlock();

int getAggregatorInterval();

int loadCatClientConfig(const char* file);

void clearCatClientConfig();

#endif //CAT_CLIENT_C_CLIENT_CONFIG_H
